{% load i18n %}
<div class="workflow" ng-controller="WorkflowProgressionController">
    <ol>
        <li ng-class="workflow.stageCSSClass('typing')">
            <h3>{% trans "Type what you hear" %}</h3>
            <button ng-disabled="!workflow.canCompleteStage('typing')"
                ng-click="workflow.completeStage('typing')">
                {% trans "Start syncing" %}
            </button>
        </li>

        <li ng-class="workflow.stageCSSClass('syncing')">
            <h3>{% trans "Sync Timing" %}</h3>
            <p class="stats">
                {% blocktrans with "[[ workflow.subtitleList.syncedCount]]" as count and "[[ workflow.subtitleList.length() ]]" as total %}
                synced subtitles: {{ count }} / {{ total }}
                {% endblocktrans %}
            </p class="stats">
            <button ng-disabled="!workflow.canCompleteStage('syncing')"
                ng-click="workflow.completeStage('syncing')">
                {% trans "Start syncing" %}
            </button>
        </li>

        <li ng-class="workflow.stageCSSClass('review')">
            <h3>{% trans "Review and complete" %}</h3>
            <p>
                {% trans "Check all work." %}
                <a href="#" ng-click="onEditTitleClicked($event)">{% trans "Edit title and description." %}</a>
            </p>

            <div ng-switch="taskButtons">
                <div ng-switch-when="false" class="actions">
                    <button ng-disabled="workflow.stage != 'review'" class="endorse" ng-click="session.endorse()">
                        {% trans "Publish" %}
                    </button>
                </div>
                <div ng-switch-when="true" class="actions">
                    <button ng-click="session.rejectTask()">
                        {% trans "Send Back" %}
                    </button>
                    <button ng-disabled="workflow.stage != 'review'" class="endorse" ng-click="session.approveTask()">
                        {% trans "Approve" %}
                    </button>
                </div>
            </div>
        </li>
    </ol>
</div>
