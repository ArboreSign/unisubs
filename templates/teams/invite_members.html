{% extends "teams/base.html" %}

{% load i18n teams_tags widget media_compressor %}

{% block title %}
    {% trans 'Invite Members' %} | Universal Subtitles
{% endblock %}

{% block css %}
    {{ block.super }}
     {% include_bundle "widget-css"%}
{% endblock %}

{% block view_content %}

    {% with "members" as current %}
        {% include "teams/_tabs.html" %}
    {% endwith %}

    <div class="view grid_9 alpha">
        <form method='post' action="." enctype="multipart/form-data" class="invite-members">
            {{ form.non_field_errors }}
            <div class="grid_4 alpha">
                <fieldset>
                    <legend>{% trans 'Recipient' %}</legend>
                    {{ form.errors.user_id }}
                    <label for="user_id">{% trans 'Username' %}</label>
                    <div class="ajaxChosen">
                        <select name="user_id">
                            <option value="">-----</option>
                            <option value="">{% trans 'Begin typing to search.' %}</option>
                        </select>
                    </div>
                    <p class="notation">{% trans 'Universal Subtitles username of the user you want to invite.' %}</p>
                </fieldset>
            </div>

            <div class="grid_4 omega">
                <fieldset>
                    <legend>{% trans 'Invite Details' %}</legend>

                    {{ form.errors.message }}
                    <label for="id_message">{% trans 'Include a message' %}</label>
                    {{ form.message }}

                    {{ form.errors.role }}
                    <label for="id_role">{% trans 'Assign a role' %}</label>
                    {{ form.role }}
                    <p class="notation">{% trans 'Role to be assigned to the user if they accept your invitation.' %}</p>
                </fieldset>
            </div>

            <div class="grid_9 submit">
                <button>{% trans 'Send Invites' %}</button>
            </div>

            {% csrf_token %}
        </form>
    </div>
    <div class="controls grid_3 omega">
        <ul>
            <li class="current">
                <a href="{% url teams:invite_members slug=team.slug %}">{% trans 'Invite New Members' %}</a>
            </li>
            <li>
                <a href="{% url teams:detail_members team.slug %}">‚Üê {% trans 'Back to Members' %}</a>
            </li>
        </ul>
    </div>

    <script type="text/javascript">
    
        $(function() {
            $(".ajaxChosen select").ajaxChosen({
                method: 'GET',
                url: '/en/messages/users/search/',
                dataType: 'json'
            }, function (data) {
                var terms = {};

                $.each(data.results, function (i, val) {
                    terms[data.results[i][0]] = data.results[i][1];
                });

                return terms;
            });
        });

    </script>
{% endblock %}