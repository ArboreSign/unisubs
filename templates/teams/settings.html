{% extends "base.html" %}
{% load i18n teams_tags paginator doorman media_compressor verbatim_templatetag %}

{% block scripts %}
    {{ block.super }}
    {% include_bundle "js-teams-settings-panel" %}
    <script src="{% url teams:rpc_api %}" type="text/javascript"></script>
{% endblock %}



{% block body_attrs %}class="new-teams"{% endblock %}

{% block title %}
    {{ team }} {% trans 'Settings' %} | Universal Subtitles
{% endblock %}

{% block main_content %}
    <div class="hd">
        <h2>{{ team.name }}</h2>
        {% with "settings" as active %}
            {% include 'teams/_edit_top_navigation.html' %}
        {% endwith %}
    </div>

    <div class="panel-holder grid_9 alpha">
      <div class="tab panel-projects" style="display:none">
      </div>
      {% include "teams/_basic_settings.html" %}

    </div>

    <div class=" grid_3 omega ">
      <ul class="view-filter sub-settings-panel">
      </ul>
    </div>


<script type="text/javascript">
$(window).load(function(){
    //findme
    {% include "teams/settings-panel.js" %}
});
</script>

<!-- templates -->
<script id="IMAGE_PRELOADER" type="text/html">
  <img  width="256" height1="30" src="{{ STATIC_URL }}images/ajax-loader.gif"/>
</script>
{% comment %}  Whatever is inside the verbatim tag does not run through
django's var subtitution, so the final template is render as it's written bellow.
This is needed, since it's for the js templating
{% endcomment %}
{% verbatim %}

<script id="subMenuItem" type="text/html">
  <li><a >{{label}}</a></li>
</script>

<script id="projectPanel" type="text/html">
  <div class="panel-project">
    <a  class="button project-add">Add Project</a>
    <ul class="projects listing">
    </ul>
  </div>
</script>

<script id="projectEditPanel" type="text/html">
  <div class="project-edit-panel modal-window-bg">
    <form action="#">
      <h3> Change project {{name}}</h3>
      <label for="name">Name</label>
      <input type="text" name="name" class="clearfix" value="{{name}}"/>

      <label for="name">Description</label>

      <textarea  name="description" class="clearfix" >{{description}}</textarea>
      <input type="hidden" value='{{pk}}' name="pk"/>
      <input type="hidden" value='{{order}}' name="order"/>
      <input type="hidden" value='{{slug}}' name="slug"/>
      <div class="clearfix"/>
      <b> Workflows</b>
      <label for="workflow_enabled">Moderate this project's subtitles. Wil override the team's workflow if exists.</p>
<input type="checkbox"  name="workflow_enabled" {{#workflow_enabled}}checked="checked"{{/workflow_enabled}}/>


      <a class="red_button project-delete">Delete</a>
      <a class="blue_button project-save">Save</a>
      <a class="blue_button project-cancel">Changed my mind just cancel</a>

    </form>
  </div>
</script>

<script id="projectListItem" type="text/html">
  <li>
    <span><a href="{{url}}">{{name}}</a>
    <ul class="actions">
      <li>
        <a class="action-edit" href="#">Edit</a>
      </li>
    </ul>
  </li>
</script>

<script id="tasksLanguagesList" type="text/html">
    <select id="id_task_language" name="language">
        <option value="">All Languages</option>
    </select>
</script>
<script id="tasksLanguagesListOption" type="text/html">
    <option value="{{ language }}">{{ language_display }}</option>
</script>
<script id="tasksTypesList" type="text/html">
    <ul class="types">
        <li class="type selected">
            All Pending
            <input type="hidden" name="type" value="" />
        </li>
        <li class="type">
            Review
            <input type="hidden" name="type" value="Review" />
        </li>
        <li class="type">
            Approve
            <input type="hidden" name="type" value="Approve" />
        </li>
        <li class="type">
            Translate
            <input type="hidden" name="type" value="Translate" />
        </li>
        <li class="type">
            Subtitle
            <input type="hidden" name="type" value="Subtitle" />
        </li>
    </ul>
</script>

<script id="confirmationDialog" type="text/html">
    <div class="modal-window-bg">
      <h3>{{title}}</h3>
      <div>{{body}}</div>
      <p class="clearfix"></p>
      <button class="red_button small submit_button cancel">{{cancelText}}</button>
      <button class="blue_button small submit_button confirm">{{okText}}</button>
    </div>
</script>

<script id="tasksListItem" type="text/html">
    <p>
        {{ #ghost }}
            <b>GHOST</b>
        {{ /ghost }}
        {{ #completed }}
            <b>COMPLETED</b>
        {{ /completed }}
        <a href="{{ teamVideoUrl }}">{{ teamVideoDisplay }}</a>
        <br/>
        <span>
            {{ #languageDisplay}}
                {{ languageDisplay }} subtitles
            {{ /languageDisplay}}

            {{ ^languageDisplay}}
                Transcription Needed
            {{ /languageDisplay}}
        </span>
        <br/>
        <span class="assignee">
            {{ #assigneeDisplay }}
                Assigned to {{ assigneeDisplay }}
            {{ /assigneeDisplay }}

            {{ ^assigneeDisplay }}
                Unassigned
            {{ /assigneeDisplay }}
        </span>
    </p>
    <p class="done">
        {{ #steps }}
            {{ #done }}
                &#x2611;
            {{ /done }}
            {{ ^done }}
                &#x2610;
            {{ /done }}
        {{ /steps }}

        {{ stepDisplay }}
    </p>
    <ul class="actions">
        <li>
            {{ #assignAllowed }}
                <form action="" method="post">
                    <a class="action-assign" href="#">Assign</a>
                    <div class="assignee-choice" style="display: none;">
                        {% endverbatim %}
                            {{ assign_form.assignee }}
                        {% verbatim %}
                        <a class="action-assign-submit" href="#">Assign to User</a>
                    </div>
                </form>
            {{ /assignAllowed }}

            {{ #deleteAllowed }}
                <a class="action-delete" href="#">Delete</a>
            {{ /deleteAllowed }}

            <form action="{{ performUrl }}" method="post">
                {% endverbatim %}
                    {% csrf_token %}
                {% verbatim %}
                <input type="hidden" name="task_id" value="{{ pk }}" />
                {{ #performAllowed }}
                    <a class="perform" href="#">Perform Task</a>
                {{ /performAllowed }}
            </form>
        </li>
    </ul>
</script>
<script id="tasksPanel" type="text/html">
    <div class="panel-tasks">
        <form id="tasks_type_filter"></form>

        <form id="tasks_language_filter">
            <label for="id_task_language">Language needed:</label>
        </form>

        <ul class="tasks listing"></ul>
    </div>
</script>

<script id="guidelinesPanel" type="text/html">
    <div class="panel-guidelines">
        <form id="guidelines_messages_form">
            <div class="messages">
                <h3>Custom messages</h3>
                <p class="description">
                    Customize the messages sent to your users.
                    The text you enter will preceed the default system message.
                </p>

                <label for="id_messages_invite">When a member is invited to join the team</label><br/>
                <textarea id="id_messages_invite" name="messages_invite"></textarea><br/>

                <label for="id_messages_manager">When a member is given the Manager role</label><br/>
                <textarea id="id_messages_manager" name="messages_manager"></textarea><br/>

                <label for="id_messages_admin">When a member is given the Admin role</label><br/>
                <textarea id="id_messages_admin" name="messages_admin"></textarea><br/>
            </div>
            <div class="guidelines">
                <h3>Guidelines</h3>
                <p class="description">
                    Add guidelines to be displayed to your users when completing tasks.
                </p>

                <label for="id_guidelines_subtitle">When creating subtitles</label><br/>
                <textarea id="id_guidelines_subtitle" name="guidelines_subtitle"></textarea><br/>

                <label for="id_guidelines_translate">When translating</label><br/>
                <textarea id="id_guidelines_translate" name="guidelines_translate"></textarea><br/>

                <label for="id_guidelines_review">When reviewing</label><br/>
                <textarea id="id_guidelines_review" name="guidelines_review"></textarea><br/>
            </div>

            <input type="submit" class="submit" value="Save Changes" name="save" />
        </form>
    </div>
</script>

<script id="basicPanel" type="text/html">
    <div class="panel-basic">
        <div id="basic_settings_form">
            <form class="team-settings">
                <h3>Team Details</h3>

                <label for="basic_name">Name</label>
                <input id="basic_name" type="text" name="name" value="" />

                <label for="basic_description">Description</label>
                <textarea id="basic_description" name="name"></textarea>
            </form>

            <form class="logo" action="{% endverbatim %}{% url teams:upload_logo team.slug %}{% verbatim %}" method="POST">
                <div style="float: left; clear: both; margin: 30px 0;">
                    {% endverbatim %}{% csrf_token %}{% verbatim %}
                    <img id="current_logo" src="" style="max-width: 100px; max-height: 100px; border: 1px solid black;"/>
                    <br/>
                    <input type="file" id="basic_picture" name="logo" />
                    <button class="green_button small upload-picture">
                        <span>Upload a Logo</span>
                    </button>
                </div>
                <p class="help">Max size 000x000</p>
            </form>

            <form class="team-settings">
                <h3>Permissions</h3>

                <label for="id_membership_policy">Who can join</label>
                {% endverbatim %}{{ settings_form.membership_policy }}{% verbatim %}

                <label for="id_video_policy">Who can add videos</label>
                {% endverbatim %}{{ settings_form.video_policy }}{% verbatim %}
            </form>

            <form class="team-settings">
                <h3>Workflows</h3>
                <p class="help">Moderate subtitles on your videos</p>

                <input type="checkbox" name="workflows_enabled" id="basic_workflows_enabled"/>
                <label for="basic_workflows_enabled">Enable workflows</label>
            </form>

            <form action="" class="workflow" method="post"></form>

            <form class="team-settings"><input type="submit" class="submit" value="Save Changes" name="save" /></form>
        </div>
    </div>
</script>

<script id="workflow" type="text/html">
    <form>
        <label>Subtitle</label>
        <select name="perm_subtitle">
            <option value="20">Open to public</option>
            <option value="30">Open to team</option>
            <option value="40">Managers and admins</option>
            <option value="50">Admins only</option>
        </select>

        <label>Translate</label>
        <select name="perm_translate">
            <option value="20">Open to public</option>
            <option value="30">Open to team</option>
            <option value="40">Managers and admins</option>
            <option value="50">Admins only</option>
        </select>

        <label>Review</label>
        <select name="perm_review">
            <option value="10">None</option>
            <option value="30">Open to team</option>
            <option value="40">Managers and admins</option>
            <option value="50">Admins only</option>
            <option value="60">Owner only</option>
        </select>

        <label>Approve</label>
        <select name="perm_approve">
            <option value="10">None</option>
            <option value="40">Managers and admins</option>
            <option value="50">Admins only</option>
            <option value="60">Owner only</option>
        </select>

        <input type="submit" class="submit" value="Save Workflow Changes" name="save" />
    </form>
</script>

{% endverbatim %}
{% endblock %}
