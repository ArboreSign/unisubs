<!DOCTYPE html>
<html ng-app="amara.SubtitleEditor">
<head>
    <title>Editing {{ language.language_code }} for {{ video }}</title>
    <script src="{{ STATIC_URL }}src/js/third-party/amara-jquery-1.8.2.min.js"></script>
    <script src="{{ STATIC_URL }}src/js/third-party/angular.1.0.3.js"></script>
    <script src="{{ STATIC_URL }}src/js/third-party/underscore.min.js"></script>
    <script src="{{ STATIC_URL }}src/js/subtitle-editor/editor-app.js"></script>
    <script src="{{ STATIC_URL }}src/js/subtitle-editor/directives/subtitles.js"></script>
    <script src="{{ STATIC_URL }}src/js/subtitle-editor/directives/helper-selector.js"></script>
    <script src="{{ STATIC_URL }}src/js/subtitle-editor/services/services.js"></script>
    <script src="{{ STATIC_URL }}src/js/subtitle-editor/services/subtitles.js"></script>
    <script src="{{ STATIC_URL }}src/js/dfxp/dfxp.js"></script>
    <script src="{{ STATIC_URL }}src/js/subtitle-editor/controllers/subtitle-list.js"></script>
</head>
<body>

<h1>Editing {{ language.language_code }} for {{ video }} </h1>
<script type="text/javascript">
    var editorData = {{ editor_data|safe }}
</script>
{#Angular app#}
    <div class="topbar"></div>
    <div class="help-area">
        Help translating
    </div>
    <div class="video-player">
        
    </div>
    <div class="additional-info">
        <select name="info-type" id="info-type">
            <option value="subtitles">Existing Subtitles</option>
        </select>
        <select name="alternate-language" id="alternate-language"
            ng-controller="HelperSelectorController">
            <option
                language-value=""
                ng-repeat="item in languageValue"
                value="">[[ item ]]</option>
        </select>
        <select name="alternate-version" id="alternate-version">
            <option value="{{ alternateVersion.number }}">{{ alternateVersion.number }}</option>
        </select>
    </div>
    {# This is the reference subtitle list #}
    <div class="subtitling-area">
        {#  the value for subtitle-list attribute is what allows the subtitleListWidgetFinder #}
        {#  to identify which list should be updated when we change the reference version #}
        <ul subtitle-list="reference-subtitle-set" ng-controller="SubtitleListController"
            editable="false"
            version-number="{{ translated_from_version.version_number }}"
            language-code="{{ translated_from_version.subtitle_language.language_code }}"
            video-id="{{ video.video_id }}">

                [[ subtitlesData.length ]] subs

            <li ng-repeat="subtitle in subtitlesData"
                ng-controller="SubtitleListItemController"
                ng-class="{selected : subtitle.index == selectedIndex}"
                class="subtitle-list-item"
                    subtitle-list-item>
                <span ng-show="!isEditing" class="subtitle-text" ng-bind-html-unsafe="subtitle.text"></span>
                <textarea ng-show="isEditing"></textarea>
            </li>
        </ul>
    </div>
    {# This is the actual editable subtitle list#}
    <div class="subtitling-area">
        <ng-switch on="status">
            <p ng-switch-when="loading">Loading subtitles</p>
            <p ng-switch-when="saving">Saving subtitles</p>

        <ul subtitle-list="editing-subtitle-set" ng-controller="SubtitleListController"
            editable="true"
            ng-switch-when="ready"
            version-number="{{ version.version_number }}"
            language-code="{{ language.language_code }}"
            video-id="{{ video.video_id }}">

                [[ subtitlesData.length ]] subs

            <li ng-repeat="subtitle in subtitlesData"
                ng-controller="SubtitleListItemController"
                ng-class="{selected : subtitle.index == selectedIndex}"
                class="subtitle-list-item"
                    subtitle-list-item>
                <span ng-show="!isEditing" class="subtitle-text" ng-bind-html-unsafe="subtitle.text"></span>
                <textarea ng-show="isEditing"></textarea>
            </li>
        </ul>
            </ng-switch>
        <button ng-click="saveSubtitles">Save</button>
    </div>
</body>
</html>
