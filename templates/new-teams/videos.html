{% extends "new-teams/base.html" %}

{% load i18n videos_tags %}
{% load url from future %}

{% block content %}

<h2>{% blocktrans %}Videos for {{ team }}{% endblocktrans %}</h2>
<div class="split-view">
  <div class="sidebar">
    <div class="section filters">
      {% include "new-teams/_video-filters.html" %}
    </div>
    {% if forms.add.enabled or forms.move.enabled %}
    <div class="section tools">
      {% if forms.add.enabled %}
      <a class="button open-modal" data-modal="add-form">{% trans "Add Video" %}</a>
      {% endif %}
      {% if forms.move.enabled %}
      <a href="{% url "teams:move_videos" team.slug %}{% if request.META.QUERY_STRING %}?{{ request.META.QUERY_STRING }}{% endif %}" class="button">{% trans "Bulk Move Videos" %}</a>
      {% endif %}
    </div>
    {% endif %}
  </div>
  <div class="main">
    {% if page %}
    <ul class="thumb-list team-videos">
      {% for team_video in team_videos %}
      {% with video=team_video.video %}
      <li>
        <a class="thumb" href="{% url "videos:video" video_id=video.video_id %}">
          <img src="{{ video.get_wide_thumbnail }}" alt="{{ video.title_display }}">
          {% if video.duration %}<div class="badge">{{ video.duration|format_duration }}</div>{% endif %}
        </a>
        <div class="extra-info">{{ video.get_primary_audio_language_code_display }}</div>
        <h6 class="one-line">
          <a href="{% url "videos:video" video_id=video.video_id %}">{{ video.title_display }}</a>
        </h6>
        <div class="three-lines">{{ video.description|urlize|linebreaks }}</div>
        <div class="secondary-actions">
          {% if forms.move.enabled %}
          <button class="open-modal" title="{% trans "move video" %}" data-modal="move-form" data-heading="{% blocktrans with title=video.title_display %}Move Team Video: {{ title }}{% endblocktrans %}" data-set-form-values='{"team_video": {{ team_video.id }}}' href="#"><span class="fa fa-arrow-right"></span></button>
          {% endif %}
          {% if forms.remove.enabled %}
          <button class="open-modal" title="{% trans "remove video" %}" data-modal="remove-form" data-heading="{% blocktrans with title=video.title_display %}Remove Video from Team: {{ title }}{% endblocktrans %}" data-set-form-values='{"team_video": {{ team_video.id }}}' href="#"><span class="fa fa-remove"></span></button>
          {% endif %}
        </div>
        {% if forms.edit.enabled %}
        <button class="open-modal" data-modal="edit-form" data-heading="{% blocktrans with title=video.title_display %}Edit Team Video: {{ title }}{% endblocktrans %}" data-set-form-values='{"team_video": {{ team_video.id }}, "primary_audio_language": "{{ video.primary_audio_language_code }}", "project": "{{team_video.project_id }}" }'>{% trans "edit" %}</button>
        {% endif %}
      </li>
      {% endwith %}
      {% endfor %}
    </ul>
    {% include "_new_paginator.html" %}
    {% else %}
    <p class="empty">{% trans "No Videos found" %}</p>
    {% endif %}
  </div>
</div>

{% if forms.add.enabled %}
<aside class="modal" id="add-form">
  <h3>{% trans "Add Video" %}</h3>
  <form action="" method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <button class="close"></button>
    <input type="hidden" name="form" value="add">
    {% include "_field.html" with field=forms.add.video_url %}
    {% include "_field.html" with field=forms.add.project %}
    {% include "_field.html" with field=forms.add.thumbnail %}
    <footer class="buttons">
      <button>{% trans "Add" %}</button>
    </footer>
  </form>
</aside>
{% endif %}

{% if forms.edit.enabled %}
<aside class="modal" id="edit-form">
  <h3></h3>
  <form action="" method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <button class="close"></button>
    <input type="hidden" name="form" value="edit">
    <input type="hidden" name="team_video">
    {% include "_field.html" with field=forms.edit.primary_audio_language %}
    {% include "_field.html" with field=forms.edit.project %}
    {% include "_field.html" with field=forms.edit.thumbnail %}
    <footer class="buttons">
      <button>{% trans "Update" %}</button>
    </footer>
  </form>
</aside>
{% endif %}

{% if forms.move.enabled %}
<aside class="modal" id="move-form">
  <h3></h3>
  <form action="" method="POST">
    {% csrf_token %}
    <button class="close"></button>
    <input type="hidden" name="form" value="move">
    <input type="hidden" name="team_video">
    {% include "_field.html" with field=forms.move.new_team %}
    <footer class="buttons">
      <button>{% trans "Move" %}</button>
    </footer>
  </form>
</aside>
{% endif %}

{% if forms.remove.enabled %}
<aside class="modal" id="remove-form">
  <h3></h3>
  <form action="" method="POST">
    {% csrf_token %}
    <button class="close"></button>
    <input type="hidden" name="form" value="remove">
    <input type="hidden" name="team_video">
    <p class="confirmation">{% trans "Are you sure you want to remove this video from your team?" %}</p>
    <footer class="buttons">
      <button>{% trans "Remove" %}</button>
    </footer>
  </form>
</aside>
{% endif %}

{% endblock %}
